(this["webpackJsonpimage-search-app"]=this["webpackJsonpimage-search-app"]||[]).push([[0],{104:function(e,t,a){e.exports=a(177)},161:function(e,t,a){},177:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(32),o=a.n(c),l=(a(109),a(161),a(7)),i=a(17),s=a(27),u=Object(s.b)({key:"favoritesState",default:[]}),m=function(e){var t=localStorage.getItem(u.key);t&&e.set(u,JSON.parse(t).value)},d=function(){return Object(s.d)((function(e){var t=e.snapshot.getLoadable(u);"hasValue"===t.state&&localStorage.setItem(u.key,JSON.stringify({value:t.contents}))})),null},f=r.a.memo((function(e){return r.a.createElement("div",{className:"indicator",style:{width:e.size,height:e.size}})})),p=a(1),v=a(185),h=a(186),b=a(182),E=a(183),g=a(184),O=a(102),j=a(5),_=a.n(j),w=a(13),N=a(2),k="https://api.unsplash.com/",S="FvPWrJKqhuR0yycM1YFs5zgY9T5NnSOP5eR_4GYx4iY",y=function(){var e=function(){var e=Object(n.useState)(!1),t=Object(p.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(),o=Object(p.a)(c,2),l=o[0],i=o[1],s=Object(n.useCallback)(function(){var e=Object(w.a)(_.a.mark((function e(t,a){var n,c,o,l,s,u,m=arguments;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m.length>2&&void 0!==m[2]?m[2]:null,c=m.length>3?m[3]:void 0,o=new AbortController,l=setTimeout((function(){o.abort()}),1e4),i(void 0),r(!0),e.prev=6,e.next=9,fetch(t,{headers:Object(N.a)(Object(N.a)({},c),{},{"Content-Type":"application/json"}),mode:"cors",method:a,signal:o.signal,body:"POST"===a?JSON.stringify(n):null});case 9:if(s=e.sent,r(!1),s.ok){e.next=15;break}return u=new Error("Fetch failed: ".concat(s.statusText)),i(u),e.abrupt("return",Promise.reject(u));case 15:return e.next=17,s.json();case 17:return e.abrupt("return",e.sent);case 20:return e.prev=20,e.t0=e.catch(6),r(!1),i(e.t0),e.abrupt("return",Promise.reject(new Error("Fetch failed: ".concat(e.t0))));case 25:return e.prev=25,clearTimeout(l),e.finish(25);case 28:case"end":return e.stop()}}),e,null,[[6,20,25,28]])})));return function(t,a){return e.apply(this,arguments)}}(),[]),u=function(e){return e?"?"+Object.keys(e).map((function(t){return t+"="+e[t].toString()})).join("&"):""};return{loading:a,error:l,get:Object(n.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s(e+u(t),"GET",null,a)}),[s]),post:Object(n.useCallback)((function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s(e,"POST",t,a)}),[s])}}(),t=e.loading,a=e.error,r=e.get;return{error:a,search:function(){var e=Object(w.a)(_.a.mark((function e(t){var a,n=arguments;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.length>1&&void 0!==n[1]?n[1]:1,e.next=3,r(k+"photos/random",{query:encodeURIComponent(t),orientation:"portrait"},{Authorization:"Client-ID ".concat(S)}).catch((function(e){}));case 3:return a=e.sent,e.abrupt("return",a||null);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),loading:t}},C=function(e){return r.a.createElement("input",{className:"search-input","data-testid":"search-input",placeholder:"please search image word",value:e.word,onChange:function(t){return e.changeInput(t.target.value)}})},x=a(56),F=a.n(x),I=a(36),P={required:"title is required",minLength:{value:2,message:"Please title enter at least 2 characters"},maxLength:{value:30,message:"Please title enter within 30 characters"}},R={required:"description is required",minLength:{value:2,message:"Please enter at least 2 characters"},maxLength:{value:128,message:"Please enter within 128 characters"}},L=function(e){var t=Object(I.a)(),a=t.register,n=t.handleSubmit,c=t.errors;return r.a.createElement("form",{onSubmit:n(e.onSubmit)},r.a.createElement("label",{htmlFor:"title"},"Title"),r.a.createElement("input",{type:"text",name:"title",ref:a(P)}),c.title&&r.a.createElement("span",{role:"alert",className:"error"},c.title.message),r.a.createElement("label",{htmlFor:"description"},"Description"),r.a.createElement("input",{type:"text",name:"description",ref:a(R)}),c.description&&r.a.createElement("span",{role:"alert",className:"error"},c.description.message),r.a.createElement("input",{type:"submit",value:"Add"}))},M=function(e){var t=Object(I.a)(),a=t.register,n=t.handleSubmit;return r.a.createElement("form",{onSubmit:n(e.onSubmit)},r.a.createElement("select",{name:"favoriteId",ref:a},e.favorites.map((function(e,t){return r.a.createElement("option",{key:t,value:e.id},e.title)}))),r.a.createElement("input",{type:"submit",value:"Add"}))},T=function(e){return r.a.createElement(F.a,{className:"modal",overlayClassName:"modal-overlay",isOpen:e.isOpen,onRequestClose:e.closeModal},r.a.createElement("div",{className:"favorite-confirm-modal-content"},r.a.createElement("div",{className:"favorite-confirm-modal-content__list"},r.a.createElement("h3",null,"List"),r.a.createElement(M,{favorites:e.favorites,onSubmit:function(t){var a=e.favorites.find((function(e){return e.id===t.favoriteId}));a&&e.addFavorite(a)}})),r.a.createElement("div",{className:"favorite-confirm-modal-content__new-list"},r.a.createElement("h3",null,"New List"),r.a.createElement(L,{onSubmit:function(t){var a=Object(N.a)(Object(N.a)({},t),{},{photos:[]});e.addFavorite(a)}}))))},q=a(73),z=a.n(q),A=a(187),D=function(){var e=Object(s.c)(u),t=Object(p.a)(e,2),a=t[0],n=t[1];return{favorites:a,addFavorite:function(e,t){var r=z()(a),c=r.findIndex((function(t){return t.id===e.id}));c<0?(e.id=Object(A.a)(),e.photos=[t],r.push(e)):r[c].photos.push(t),n(r)},updateFavorite:function(e){var t=z()(a),r=t.findIndex((function(t){return t.id===e.id}));r<0||(t[r]=e,n(t))}}},J=r.a.memo((function(e){return r.a.createElement("div",{className:e.className?"user-info ".concat(e.className):"user-info"},r.a.createElement("a",{href:e.user.links.html,target:"_blank",rel:"noopener noreferrer"},r.a.createElement("img",{src:e.user.profile_image.small,alt:e.user.username}),e.user.username))})),W=function(e,t){var a=document.createElement("a"),n=new Blob([e],{type:"image/*"});a.href=URL.createObjectURL(n),a.download=t,a.click()},Y=function(e){var t=function(){var e=Object(n.useState)(!1),t=Object(p.a)(e,2),a=t[0],r=t[1];return{isOpen:a,openModal:Object(n.useCallback)((function(){r(!0)}),[]),closeModal:Object(n.useCallback)((function(){r(!1)}),[])}}(),a=t.isOpen,c=t.closeModal,o=t.openModal,l=D(),i=l.favorites,s=l.addFavorite,u=Object(n.useCallback)((function(){W(e.photo.urls.regular,"".concat(e.photo.id,".jpg"))}),[e.photo.urls.regular,e.photo.id]),m=Object(n.useCallback)((function(t){s(t,e.photo),c()}),[s,c,e.photo]);return r.a.createElement("div",{className:"search-result",style:{backgroundImage:"url(".concat(e.photo.urls.small,")"),width:400,height:400*e.photo.height/e.photo.width}},r.a.createElement("div",{className:"search-result-controll"},r.a.createElement("button",{onClick:u},"download"),r.a.createElement("button",{onClick:o},"save")),r.a.createElement(J,{user:e.photo.user}),r.a.createElement(T,{favorites:i,addFavorite:m,isOpen:a,closeModal:c}))},B=function(){var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=y(),a=t.loading,r=t.search,c=t.error,o=Object(n.useState)(e),l=Object(p.a)(o,2),i=l[0],s=l[1],u=Object(v.a)((function(e,t){return t.pipe(Object(h.a)(500),Object(b.a)(),Object(E.a)((function(e){var t;return(null===(t=e[0])||void 0===t?void 0:t.length)>1})),Object(g.a)((function(e){return r(e[0])})),Object(O.a)((function(e){return e})))}),null,[i]);return{error:c,loading:a,word:i,setWord:s,searchResult:u}}(),t=e.loading,a=e.word,c=e.setWord,o=e.searchResult,l=e.error;return r.a.createElement("div",{className:"search-page"},r.a.createElement("form",null,r.a.createElement(C,{word:a,changeInput:c})),l&&r.a.createElement("p",{role:"alert",className:"error"},l.message),o?r.a.createElement(Y,{photo:o}):t&&r.a.createElement(f,{size:100}),r.a.createElement(f,{size:100}))},U=r.a.memo((function(e){var t=Object(n.useRef)(null),a=Object(n.useState)(!1),c=Object(p.a)(a,2),o=c[0],l=c[1],i=Object(n.useCallback)((function(a,n){a.forEach((function(a){if(a.isIntersecting){if(a.intersectionRatio>0&&n.unobserve(a.target),!o){var r=new Image;r.onload=function(){t.current&&(t.current.setAttribute("src",r.src),l(!0))},r.src=e.src,n.unobserve(a.target)}n.unobserve(a.target)}}))}),[o,e.src]);return Object(n.useEffect)((function(){if(t.current){var e=new IntersectionObserver(i,{rootMargin:"50px"});return o||e.observe(t.current),function(){t.current&&e.unobserve(t.current)}}}),[o,i]),r.a.createElement("img",Object.assign({},e,{src:e.src,alt:e.alt,ref:t}))})),V=r.a.memo((function(e){return r.a.createElement("div",{className:"favorite-item"},r.a.createElement("div",{className:"favorite-item__img-wrapper"},r.a.createElement("div",{className:"favorite-item__img-wrapper__controll"},r.a.createElement("button",{onClick:function(){return e.onDownload(e.data)}},"download")),r.a.createElement(U,{src:e.data.urls.thumb})))})),G=r.a.memo((function(e){var t=Object(I.a)(),a=t.register,n=t.handleSubmit;return r.a.createElement("div",{className:"favorite-edit-info-form"},r.a.createElement("form",{onSubmit:n(e.onSubmit)},r.a.createElement("input",{type:"text",name:"title",defaultValue:e.favorite.title,ref:a(P)}),r.a.createElement("input",{type:"text",name:"description",defaultValue:e.favorite.description,ref:a(R)}),r.a.createElement("input",{type:"submit",value:"Save"})))})),K=r.a.memo((function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(n.useState)(e),a=Object(p.a)(t,2),r=a[0],c=a[1],o=Object(n.useCallback)((function(){c(!r)}),[r]);return{isOpen:r,toggle:o}}(),a=t.isOpen,c=t.toggle,o=Object(n.useCallback)((function(t){e.onSubmit(Object(N.a)(Object(N.a)({},e.data),t)),c()}),[e,c]);return r.a.createElement("div",{className:"favorite-collection"},r.a.createElement("div",{className:"favorite-collection__info-wrapper"},r.a.createElement("div",{className:"favorite-collection__info-wrapper__contents"},a?r.a.createElement(G,{favorite:e.data,onSubmit:o}):r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{className:"favorite-collection__info-wrapper__contents__title"},e.data.title),r.a.createElement("p",{className:"favorite-collection__info-wrapper__contents__description"},e.data.description))),r.a.createElement("div",{className:"favorite-collection__info-wrapper__controll"},r.a.createElement("button",{onClick:c},a?"Cancel":"Edit"))),r.a.createElement("ul",{"data-testid":"favorite-collection__list",className:"favorite-collection__list-wrapper"},e.data.photos.map((function(t,a){return r.a.createElement("li",{className:"favorite-collection__list-wrapper__list-item",key:a},r.a.createElement(V,{data:t,onDownload:e.onDownload}))}))))})),$=function(){var e=D(),t=e.favorites,a=e.updateFavorite,c=Object(n.useCallback)((function(e){W(e.urls.regular,"".concat(e.id,".jpg"))}),[]),o=Object(n.useCallback)((function(e){a(e)}),[a]);return r.a.createElement("div",{className:"favorites-page"},r.a.createElement("ul",null,t.map((function(e,t){return r.a.createElement("li",{key:t},r.a.createElement(K,{data:e,onDownload:c,onSubmit:o}))}))))},H=function(){return r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"/search",component:B}),r.a.createElement(l.b,{path:"/favorites",component:$}),r.a.createElement(l.a,{exact:!0,from:"/",to:"/search"}),r.a.createElement(l.b,{render:function(){return r.a.createElement("p",null,"Not Found!")}}))},Q=a(43),X=r.a.memo((function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"header"},r.a.createElement("div",{className:"header__wrapper"},r.a.createElement("ul",{className:"header__wrapper__nav"},r.a.createElement("li",null,r.a.createElement(Q.a,{to:"/search"},"Search")),r.a.createElement("li",null,r.a.createElement(Q.a,{to:"/favorites"},"Favorites"))))),r.a.createElement("main",{className:"main"},e.children))}));var Z=function(){F.a.setAppElement("#root");var e=Object(i.a)();return r.a.createElement(s.a,{initializeState:m},r.a.createElement(d,null),r.a.createElement(l.c,{history:e},r.a.createElement(X,null,r.a.createElement(H,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(n.StrictMode,null,r.a.createElement(Z,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[104,1,2]]]);
//# sourceMappingURL=main.67e04e60.chunk.js.map